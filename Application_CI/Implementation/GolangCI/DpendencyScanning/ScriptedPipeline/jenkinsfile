
node {
    // Checkout the source code from the Git repository
    git branch: 'main', url: 'https://github.com/OT-MICROSERVICES/employee-api.git'
    
    // Define environment variables if needed
    // Example: def PATH = '/usr/local/bin:$PATH'
    
    try {
        // Install OWASP Dependency-Check
        sh 'wget https://dl.bintray.com/jeremy-long/owasp/dependency-check-6.3.0-release.zip'
        sh 'unzip dependency-check-6.3.0-release.zip'
        
        // Run OWASP Dependency-Check for GoLang project
        sh './dependency-check/bin/dependency-check.sh --scan ./your-golang-project -f JSON -o dependency-report'
        
        // Execute build commands
        sh 'make build' // Example: Use Makefile for building
        
        // Execute test commands
        sh 'make test' // Example: Use Makefile for testing
        
        // Deploy only from the master branch
        if (env.BRANCH_NAME == 'master') {
            // Execute deployment commands
            sh 'make deploy' // Example: Use Makefile for deployment
        }
    } finally {
        // Archive dependency report for reference
        archiveArtifacts artifacts: 'dependency-report/**'
        
        // Clean up workspace after build
        cleanWs()
    }
}
